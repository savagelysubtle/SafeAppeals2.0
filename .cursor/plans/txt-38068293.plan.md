<!-- 38068293-f857-4210-beb8-0ffe8afb36fe e077efe9-76d1-400c-822b-3e8ac26aaa77 -->
# Add Built-in Rich Text Editor for .txt

## Decisions

- Storage model: Plain text only (visual formatting only) — no persisted rich markup
- Location: `extensions/txt-rich-editor` (built-in extension)

## Files to Add

- `extensions/txt-rich-editor/package.json`
- `extensions/txt-rich-editor/src/extension.ts`
- `extensions/txt-rich-editor/tsconfig.json` (simple outDir to `out`)
- `extensions/txt-rich-editor/media/editor.html` (minimal toolbar + contenteditable)
- `extensions/txt-rich-editor/.vscodeignore` (exclude dev files from packaging)

## Changes to Existing Files

- Update `build/lib/extensions.ts`: add `txt-rich-editor` to `allowedExtensions` set so it’s included when packaging local extensions

## Key Implementation Notes

- Register a `CustomTextEditorProvider` with `viewType: 'txtRichEditor.editor'`
- Selector: `"*.txt"`, `priority: "option"` so the default text editor is still available via “Reopen with”
- Webview: enable scripts; post message on doc changes; receive `edit` messages, update document via `WorkspaceEdit`
- Keep content as plain text in the model; the toolbar only affects display (no persistence of styles)
- Ensure `activationEvents` and `main` point to compiled `out/extension.js`
- Keep extension kind compatible with desktop and web (omit `main` when running web-only; but we will primarily target desktop)

## Validation Steps (no running by me per your rules)

1. Install deps: `npm ci`
2. Build core + extensions (terminal 1): `npm run watch`
3. Launch desktop: `./scripts/code.bat` (Windows) or `./scripts/code.sh` (Linux/macOS)
4. Open a `.txt` file → “Reopen with…” → select “Rich Text Editor”
5. Type and toggle Bold/Italic/Underline; verify file saves plain text

## Follow-ups (Optional)

- Add rich editor library (Lexical/Quill) and lazy-load assets
- Add a command palette entry “Open with Rich Text Editor”
- Add web compatibility (mark as `extensionKind: ["ui"]`, remove Node-only deps)

### To-dos

- [ ] Create extensions/txt-rich-editor with manifest, tsconfig, media, and src/extension.ts
- [ ] Add 'txt-rich-editor' to allowedExtensions in build/lib/extensions.ts
- [ ] Implement minimal editor.html with toolbar + contenteditable
- [ ] Ensure extension compiles to out/extension.js
- [ ] Document local validation steps and Reopen With usage